{% extends 'base.html' %}
{% block style %}
    {% load static %}
    <link rel="stylesheet" href="{% static 'profile.css' %}">
{% endblock %}
{% block content %}
<header class="container">
    
    <h2 class="title">Profile</h2>

    <div class="wrapper miniNav">
        {% if profile_content %}
            <a class="miniNavBtn" href="{% url 'profile_view' account.id %}">Profile</a>
            {% if account.id == request.user.id or perms.users.view_cwarning %}
                <a class="miniNavBtn" href="{% url 'profile_warnings' account.id %}">Warnings history</a>
            {% endif %}
            {% if perms.users.change_profile and not account.id == request.user.id %}
                {% if account.profile.is_banned %}
                    <a class="miniNavBtn" href="{% url 'profile_unban' account.id %}">Unban</a>
                {% else %}
                    <a class="miniNavBtn" href="{% url 'profile_ban' account.id %}">Ban</a>
                {% endif %}
            {% endif %}
            {% if not request.user.id == account.id %}
                <a class="miniNavBtn" href="">Start chat</a>
            {% endif %}
        {% else %}
            {% if warnings_history %}
                <a class="miniNavBtn" href="{% url 'profile_view' account.id %}">Profile</a>
                <a class="miniNavBtn" href="{% url 'profile_content' account.id %}">Content</a>
                {% if perms.users.change_profile and not account.id == request.user.id %}
                    {% if account.profile.is_banned %}
                        <a class="miniNavBtn" href="{% url 'profile_unban' account.id %}">Unban</a>
                    {% else %}
                        <a class="miniNavBtn" href="{% url 'profile_ban' account.id %}">Ban</a>
                    {% endif %}
                {% endif %}
                {% if not request.user.id == account.id %}
                    <a class="miniNavBtn" href="">Start chat</a>
                {% endif %}
            {% else %}
                <a class="miniNavBtn" href="{% url 'profile_content' account.id %}">Content</a>
                {% if account.id == request.user.id or perms.users.view_cwarning %}
                    <a class="miniNavBtn" href="{% url 'profile_warnings' account.id %}">Warnings history</a>
                {% endif %}
                {% if perms.users.change_profile and not account.id == request.user.id %}
                    {% if account.profile.is_banned %}
                        <a class="miniNavBtn" href="{% url 'profile_unban' account.id %}">Unban</a>
                    {% else %}
                        <a class="miniNavBtn" href="{% url 'profile_ban' account.id %}">Ban</a>
                    {% endif %}
                {% endif %}
                {% if not request.user.id == account.id %}
                    <a class="miniNavBtn" href="">Start chat</a>
                {% endif %}
            {% endif %}
        {% endif %}       
        
    </div>
</header>

<div class="container canvas">
    <div class="wrapper profileContainer">
        <img class="avatar" src="{{ media_url }}{{ account.profile.profile_picture }}" alt="">
        <div class="container">
            {% if perms.users.view_profile %}
                {% if account.profile.is_banned %}
                <h2 class="title"><s>{{ account.username }} ({{ account.profile.warnings }} warnings)</s></h2>
                {% else %}
                    <h2 class="title">{{ account.username }} ({{ account.profile.warnings }} warnings)</h2>
                {% endif %}
            {% else %}
                <h2 class="title">{{ account.username }}</h2>
            {% endif %}
            <p class="meta">{{ account.last_name }}</p>
        </div>
    </div>
    {% if profile_content %}
        {% for msg in content %}
        <p>Thread: {{ msg.thread }}</p>
        <a href="{% url 'thread' msg.thread.node.name|slugify msg.thread.title|slugify msg.thread.id %}">Go to this thread</a>
        {% endfor %}
    {% else %}
        {% if warnings_history %}
            {% for warn in warnings %}
                <p>Warned by: {{ warn.warned_by }}</p>
                <p>{{ warn.details }}</p>
                <p>{{ warn.time_warned }}</p>
                <a href="{% url 'thread' warn.content.thread.node.name|slugify  warn.content.thread.title|slugify warn.content.thread.id %}">Message in {{ warn.content.thread.title }}</a>
            {% endfor %}
        {% else %}
        <div class="wrapper profileInfoContainer">
            <div class="container profileInfoContainerItem">
                <p class="meta">Username:</p>
                <p class="text">{{ account.username }}</p>
            </div>
    
            <div class="container profileInfoContainerItem">
                <p class="meta">Forum title:</p>
                <p class="text">{{ account.last_name }}</p>
            </div>
    
            <div class="container profileInfoContainerItem">
                <p class="meta">Joined:</p>
                <p class="text">{{ account.date_joined|date:"d/m/Y" }}</p>
            </div>
    
            <div class="container profileInfoContainerItem profileInfoContainerEmail">
                <p class="meta">e-mail:</p>
                <p class="text">{{ account.email }}</p>
            </div>
            {% if request.user.id == account.id or perms.users.change_profile %}
            <a href="{% url 'profile_edit' account.id %}">edit</a>
            {% endif %}
        </div>
        {% endif %}
    {% endif %}
</div>
{% endblock %}